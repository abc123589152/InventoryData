@using System.Data
<title>@Model using System.Data.DataTable</title>
@using FactoryData.Controllers
@{
    HomeController ho = new HomeController();
    string Selectstr = "Select *from Fab";
    DataTable dt = ho.da(Selectstr);
}
<br />
<h2>修改</h2>
<form method="post" action="@Url.Action("DoorEdit")">
    <div class="form-horizontal">
        <hr />
        @foreach (DataRow row in Model.Rows)
        {
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">廠區</span></font>
                <div class="col-md-10">
                    <select class="form-control" name="Fab" required>
                        <option value="@row["Fab"]">@row["Fab"]</option>
                        @foreach (DataRow row1 in dt.Rows)
                        {
                            <option value="@row1["FabName"]">@row1["FabName"]</option>
                        }
                    </select>
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">門編號</span></font>
                <div class="col-md-10">
                    <input type="text" id="DoorNumber" name="DoorNumber" class="form-control" value="@row["DoorNumber"]" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">門敘述</span></font>
                <div class="col-md-10">
                    <input type="text" id="DoorName" name="DoorName" class="form-control" value="@row["DoorName"]" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">ISTAR名稱</span></font>
                <div class="col-md-10">
                    <input type="text" id="DoorIstarControlName" name="DoorIstarControlName" class="form-control" value="@row["DoorIstarControlName"]" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">讀卡機連接型態</span></font>
                <div class="col-md-10">
                    <input type="text" id="DoorConnectType" name="DoorConnectType" class="form-control" value="@row["DoorConnectType"]" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">門讀卡機型態</span></font>
                <div class="col-md-10">
                    <input type="text" id="DoorReaderType" name="DoorReaderType" class="form-control" value="@row["DoorReaderType"]" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">ACM號碼</span></font>
                <div class="col-md-10">
                    <input type="text" id="DoorAcmNumber" name="DoorAcmNumber" class="form-control" value="@row["DoorAcmNumber"]" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">讀卡機Port位</span></font>
                <div class="col-md-10">
                    <input type="text" id="DoorReaderPort" name="DoorReaderPort" class="form-control" value="@row["DoorReaderPort"]" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">新增廠商</span></font>
                <div class="col-md-10">
                    <input type="text" id="AddVendor" name="AddVendor" class="form-control" value="@row["AddVendor"]" readonly />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">新增時間</span></font>
                <div class="col-md-10">
                    <input type="date" id="AddDatetime" name="AddDatetime" class="form-control" value="@Convert.ToDateTime(row["AddDatetime"]).ToString("yyyy-MM-dd")" required />
                </div>
            </div>
            <div class="form-group">
                <font size="5"><span class="control-label col-md-2">備註</span></font>
                <div class="col-md-10">
                    <input type="text" id="Remarks" name="Remarks" class="form-control" value="@row["Remarks"]" />
                    <br />                    
                    <input type="submit" value="修改" class="btn btn-primary" />                    
                    <a href="/Home/DOOR" class="btn btn-info">返回門禁新增資訊</a>
                </div>
            </div>            
        }
    </div>
</form>

